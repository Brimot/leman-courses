<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Estimation ‚Äì L√©man Courses</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
/* ====== BASE ====== */
body{
  font-family:Arial, sans-serif;
  background:radial-gradient(circle at top, #123B5A 0%, #0B2A44 60%);
  margin:0;
  padding:30px;
}

.card{
  max-width:980px;
  margin:auto;
  background:#fff;
  padding:25px;
  border-radius:18px;
  box-shadow:0 15px 40px rgba(0,0,0,.3);
  border-top:6px solid #FDB913;
  position:relative;
  overflow:hidden;
}

.card::before{
  content:"";
  position:absolute;
  top:0; left:0; right:0;
  height:120px;
  background:linear-gradient(135deg,#FDB913,#FFCE4B);
  opacity:.15;
  z-index:0;
}

.card > *{ position:relative; z-index:1; }

h2{text-align:center;color:#0B2A44;margin:0 0 10px;font-size:28px}
.sub{text-align:center;color:#38556e;margin-top:0;font-size:14px;opacity:.8}

input,select,button{
  width:100%;
  padding:12px;
  margin-top:8px;
  border-radius:10px;
  border:1px solid #ccc;
  font-size:15px;
  box-sizing:border-box;
}

input:focus,select:focus{
  outline:none;
  border-color:#FDB913;
  box-shadow:0 0 0 2px rgba(253,185,19,.25);
}

button{
  background:#FDB913;
  color:#000;
  font-weight:bold;
  border:none;
  cursor:pointer;
  font-size:17px;
  box-shadow:0 6px 14px rgba(0,0,0,.25);
}

button:hover{
  transform:translateY(-2px);
  opacity:.92;
}

.section{
  margin-top:22px;
  padding:15px;
  border-radius:12px;
  background:#f8fbff;
  border-top:1px solid #ddd;
}

.label{font-weight:bold;color:#0B2A44;margin-bottom:6px;font-size:16px}

.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.grid-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px}
@media(max-width:820px){.grid-2,.grid-3{grid-template-columns:1fr}}

#map{
  width:100%;
  height:280px;
  margin-top:12px;
  border-radius:12px;
  border:1px solid #ccc;
  box-shadow:0 8px 20px rgba(0,0,0,.25);
}

table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{border:1px solid #ccc;padding:8px;text-align:center}
th{background:#f5f7fa;color:#0B2A44}

.smallbtn{
  background:#e6eef8;
  color:#0B2A44;
  border:1px solid #cfd9e6;
  font-weight:bold;
  padding:8px;
  border-radius:8px;
}

.badges{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-top:12px}
.badge{
  background:linear-gradient(135deg,#0B2A44,#1a4b73);
  color:#fff;
  padding:8px 14px;
  border-radius:999px;
  font-size:14px;
  box-shadow:0 4px 10px rgba(0,0,0,.3);
}

.pricebox{
  margin-top:16px;
  padding:14px;
  border-radius:12px;
  background:linear-gradient(135deg,#ffffff,#f1f6fb);
  border:1px solid #e6e6e6;
}

.pricegrid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;text-align:center}
@media(max-width:820px){.pricegrid{grid-template-columns:1fr}}
.big{font-size:22px;font-weight:700;color:#0B2A44}

.note{font-size:13px;color:#555;text-align:center;margin-top:10px;font-style:italic}
.warn{color:#b00020;font-weight:bold;text-align:center;margin-top:10px}
</style>

<script src="https://script.google.com/macros/s/AKfycbxyrSTQETLmwE94AQWwQ3HZ82dOOssy4a72CxBIFS9pdSjWFOMapogQG2j61FPHkdn1/exec" async defer></script>
</head>

<body>

<form action="TON_SCRIPT_URL" method="POST" target="_blank">
<div class="card">

<h2>üöö Estimation L√©man Courses</h2>
<p class="sub">Calcul automatique ¬∑ Google Maps ¬∑ TVA 8.1 %</p>

<div class="section">
  <div class="label">üë§ Coordonn√©es</div>
  <div class="grid-3">
    <input name="client" placeholder="Nom / Entreprise" required>
    <input name="tel" placeholder="T√©l√©phone">
    <input name="email" placeholder="E-mail" required>
  </div>
</div>

<div class="section">
  <div class="label">üìç Prise en charge</div>
  <div class="grid-2">
    <input id="pc_npa" placeholder="NPA">
    <input id="pc_ville" placeholder="Ville">
  </div>
</div>

<div class="section">
  <div class="label">üöö Livraison</div>
  <div class="grid-2">
    <input id="lv_npa" placeholder="NPA">
    <input id="lv_ville" placeholder="Ville">
  </div>
</div>

<button type="button" onclick="calculerDistance()">Calculer la distance</button>
<div id="map"></div>

<div class="badges">
  <div class="badge">Distance: <strong><span id="distance_txt">‚Äì</span> km</strong></div>
  <div class="badge">Dur√©e: <strong><span id="duree_txt">‚Äì</span> min</strong></div>
</div>

<div class="pricebox">
  <div class="label">üí∞ Prix estim√©</div>
  <div class="pricegrid">
    <div>HT<br><span class="big">CHF <span id="prix_ht">‚Äì</span></span></div>
    <div>TVA<br><span class="big">CHF <span id="prix_tva">‚Äì</span></span></div>
    <div><strong>TTC</strong><br><span class="big"><strong>CHF <span id="prix_ttc">‚Äì</span></strong></span></div>
  </div>
</div>

<button type="submit">Envoyer la demande</button>

</div>
</form>

<script>
let map, ds, dr, km=0, duree=0;

function initMap(){
  map = new google.maps.Map(document.getElementById("map"), {center:{lat:46.8,lng:8.3}, zoom:7});
  ds = new google.maps.DirectionsService();
  dr = new google.maps.DirectionsRenderer({map});
}

function calculerDistance(){
  const d = pc_npa.value+" "+pc_ville.value+", Suisse";
  const a = lv_npa.value+" "+lv_ville.value+", Suisse";

  ds.route({origin:d,destination:a,travelMode:"DRIVING"},(r,s)=>{
    if(s==="OK"){
      dr.setDirections(r);
      const leg = r.routes[0].legs[0];
      km = leg.distance.value/1000;
      duree = Math.ceil(leg.duration.value/60);
      distance_txt.innerText = km.toFixed(1);
      duree_txt.innerText = duree;
      recalculer();
    }
  });
}

function recalculer(){
  let ht = Math.max(25, km*1.2);
  let tva = ht*0.081;
  let ttc = ht+tva;
  prix_ht.innerText = ht.toFixed(2);
  prix_tva.innerText = tva.toFixed(2);
  prix_ttc.innerText = ttc.toFixed(2);
}
</script>

</body>
</html>
