<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Chauffeur â€“ LÃ©man Courses</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  font-family:Arial, sans-serif;
  background:#0B2A44;
  margin:0;
  padding:30px;
}
.card{
  max-width:600px;
  margin:auto;
  background:#fff;
  padding:25px;
  border-radius:16px;
  box-shadow:0 10px 30px rgba(0,0,0,.25);
  border-top:6px solid #FDB913;
}
h2{text-align:center;color:#0B2A44;margin-bottom:5px}
.subtitle{text-align:center;color:#555;font-size:14px}

label{
  font-weight:bold;
  color:#0B2A44;
  margin-top:15px;
  display:block;
}
input,select,textarea,button{
  width:100%;
  padding:12px;
  margin-top:6px;
  border-radius:10px;
  border:1px solid #ccc;
  font-size:16px;
}
textarea{resize:none;height:70px}

button{
  margin-top:25px;
  background:#FDB913;
  color:#000;
  font-weight:bold;
  border:none;
  cursor:pointer;
  transition:0.2s;
}
button:hover{opacity:0.9}

#msg{
  margin-top:15px;
  text-align:center;
  font-weight:bold;
}
.ok{color:green}
.err{color:#c62828}

.footer{
  text-align:center;
  margin-top:20px;
  font-size:12px;
  color:#777;
}
</style>
</head>

<body>

<div class="card">
  <h2>ðŸšš Chauffeur</h2>
  <div class="subtitle">Mise Ã  jour de livraison</div>

  <label>ID livraison</label>
  <input id="id" placeholder="LC-2026-000123">

  <label>Statut</label>
  <select id="statut">
    <option value="">â€” Choisir â€”</option>
    <option>Pris en charge</option>
    <option>En livraison</option>
    <option>Client absent</option>
    <option>LivrÃ©</option>
  </select>

  <label>Commentaire</label>
  <textarea id="comment" placeholder="Ex : DÃ©posÃ© Ã  la rÃ©ception"></textarea>

  <label>Code chauffeur</label>
  <input id="driver" placeholder="CH001">

  <button onclick="envoyer()">Valider la mise Ã  jour</button>

  <div id="msg"></div>

  <div class="footer">
    LÃ©man-Courses Â· AccÃ¨s interne
  </div>
</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbzhXJdlhFfEo_62Qy4ptqIvmhJRvNV_vs92u-zQkfgBzN-D0IzV3fc8qPqY2690PXlB/exec";

// mÃ©morisation chauffeur
driver.value = localStorage.getItem("driver") || "";

function envoyer(){
  const idv = id.value.trim();
  const stat = statut.value;
  const com = comment.value.trim();
  const drv = driver.value.trim();

  if(!idv || !stat || !drv){
    showMsg("Tous les champs obligatoires", true);
    return;
  }

  localStorage.setItem("driver", drv);

  const url = API_URL +
    "?action=update" +
    "&id=" + encodeURIComponent(idv) +
    "&statut=" + encodeURIComponent(stat) +
    "&comment=" + encodeURIComponent(com) +
    "&driver=" + encodeURIComponent(drv);

  showMsg("Envoi en cours...", false);

  fetch(url)
    .then(r => r.text())
    .then(t => {
      if(t.includes("OK")){
        showMsg("Mise Ã  jour enregistrÃ©e âœ…", false);
        comment.value="";
      }else{
        showMsg(t, true);
      }
    })
    .catch(()=>{
      showMsg("Erreur serveur", true);
    });
}

function showMsg(txt, error){
  msg.innerText = txt;
  msg.className = error ? "err" : "ok";
}
</script>

</body>
</html>
