<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Suivi LÃ©man-Courses</title>

<style>
body{
  font-family:Arial, sans-serif;
  background:linear-gradient(135deg,#0B2A44,#123B5A);
  margin:0;
  padding:30px;
}

.header{
  text-align:center;
  color:white;
  margin-bottom:20px;
}

.logo{font-size:28px;font-weight:bold;}
.slogan{font-size:14px;opacity:.8;}

.app{max-width:700px;margin:auto;}

.card{
  background:#fff;
  padding:25px;
  border-radius:18px;
  box-shadow:0 15px 40px rgba(0,0,0,.3);
  margin-top:20px;
}

input,button{
  width:100%;
  padding:12px;
  border-radius:10px;
  border:1px solid #ccc;
  font-size:16px;
}

button{
  background:#FDB913;
  border:none;
  font-weight:bold;
  margin-top:10px;
  cursor:pointer;
}

.error{color:#ff6b6b;text-align:center;margin-top:10px;}

.row{margin:8px 0;}

.badge{
  display:inline-block;
  padding:6px 12px;
  border-radius:20px;
  font-weight:bold;
  margin-bottom:10px;
}

.badge.livre{background:#4caf50;color:white;}
.badge.livraison{background:#2196f3;color:white;}
.badge.prise{background:#ff9800;color:white;}
.badge.attente{background:#999;color:white;}

.timeline .step{margin:6px 0;}
.dot{
  width:10px;height:10px;border-radius:50%;
  background:#FDB913;display:inline-block;margin-right:8px;
}
</style>
</head>

<body>

<div class="header">
  <div class="logo">ðŸšš LÃ©man-Courses</div>
  <div class="slogan">Transport express â€“ Suisse romande</div>
</div>

<div class="app">

  <input id="code" placeholder="NumÃ©ro de suivi">
  <button onclick="loadSuivi()">Suivre mon colis</button>

  <div id="error" class="error"></div>

  <div id="result" style="display:none">

    <div class="card">
      <div id="badge" class="badge"></div>
      <div class="row"><strong>Client :</strong> <span id="f_client"></span></div>
      <div class="row"><strong>Trajet :</strong> <span id="f_depart"></span> â†’ <span id="f_arrivee"></span></div>
      <div class="row"><strong>Distance :</strong> <span id="f_km"></span></div>
      <div class="row"><strong>DurÃ©e :</strong> <span id="f_duree"></span></div>
      <div class="row"><strong>DerniÃ¨re mise Ã  jour :</strong> <span id="f_update"></span></div>
    </div>

    <div class="card">
      <strong>Historique</strong>
      <div id="timeline" class="timeline"></div>
    </div>

  </div>
</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbxyrSTQETLmwE94AQWwQ3HZ82dOOssy4a72CxBIFS9pdSjWFOMapogQG2j61FPHkdn1/exec";

function loadSuivi(){
  const id = document.getElementById("code").value.trim();
  if(!id) return;

  fetch(API_URL + "?id=" + encodeURIComponent(id))
    .then(r => r.json())
    .then(d => {
      if(d.error){
        error.textContent = d.error;
        return;
      }

      result.style.display="block";
      error.textContent="";

      f_client.textContent = d.client;
      f_depart.textContent = d.depart;
      f_arrivee.textContent = d.arrivee;
      f_km.textContent = d.km + " km";
      f_duree.textContent = d.duree;
      f_update.textContent = d.date;

      const b = document.getElementById("badge");
      b.textContent = d.statut;
      b.className = "badge " + (
        d.statut=="LivrÃ©" ? "livre" :
        d.statut=="En livraison" ? "livraison" :
        d.statut=="Pris en charge" ? "prise" : "attente"
      );

      timeline.innerHTML="";
      d.history.forEach(h=>{
        timeline.innerHTML += `
          <div class="step">
            <span class="dot"></span>
            ${h.date} â€“ ${h.statut} ${h.comment||""}
          </div>
        `;
      });
    })
    .catch(()=>{
      error.textContent="Erreur de connexion";
    });
}
</script>

</body>
</html>
