<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Suivi LÃ©man-Courses</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{font-family:Arial;background:#0B2A44;padding:30px}
.card{max-width:700px;margin:auto;background:#fff;padding:25px;border-radius:16px}
input,button{width:100%;padding:12px;margin-top:10px}
.section{margin-top:15px;border-top:1px solid #ddd;padding-top:10px}
.label{font-weight:bold}
#error{color:red;margin-top:10px}
</style>
</head>
<body>

<div class="card">
<h2>ðŸ“¦ Suivi LÃ©man-Courses</h2>
<input id="code" placeholder="LC-2026-000123">
<button onclick="load()">Suivre</button>
<div id="error"></div>

<div id="res" style="display:none">
<div class="section"><div class="label">Client</div><div id="c"></div></div>
<div class="section"><div class="label">Trajet</div><div id="t"></div></div>
<div class="section"><div class="label">Distance / DurÃ©e</div><div id="d"></div></div>
<div class="section"><div class="label">Statut</div><div id="s"></div></div>
<div class="section"><div class="label">DerniÃ¨re mise Ã  jour</div><div id="u"></div></div>
<div class="section"><div class="label">Prix</div><div id="p"></div></div>
<div class="section"><div class="label">Historique</div><div id="h"></div></div>
</div>
</div>

<script>
const API = "https://script.google.com/macros/s/TON_ID/exec";

async function load(){
  const id = code.value.trim();
  if(!id){ error.innerText="Code manquant"; return; }

  try{
    const r = await fetch(API+"?id="+id);
    const d = await r.json();

    if(d.error){ error.innerText=d.error; return; }

    error.innerText="";
    res.style.display="block";

    c.innerText = d.client;
    t.innerText = d.depart+" â†’ "+d.arrivee;
    d1 = (d.km||"-")+" km Â· "+(d.duree||"-");
    d2 = d1;
    d.innerText = d1;
    s.innerText = d.statut+" ("+d.etape+")";
    u.innerText = d.date;
    p.innerText = "CHF "+d.prix;

    if(d.history.length){
      let html="";
      d.history.forEach(x=>{
        html += x.date+" â€“ "+x.statut;
        if(x.comment) html+=" ("+x.comment+")";
        html+="<br>";
      });
      h.innerHTML = html;
    } else h.innerText="Aucun historique";

  }catch(e){
    error.innerText="Erreur de connexion";
  }
}
</script>
</body>
</html>
